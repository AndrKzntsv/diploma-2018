% !TEX program = xelatex

\documentclass[crop,tikz]{standalone}

\usepackage{amsmath}
\usepackage{fontspec}
\setmainfont{CMU Serif}

\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}

\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc,patterns,angles,quotes,fit}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,foreground}

\input{../common/boat}
\input{../common/crosshatch-pattern}
\input{../common/receiver}

\tikzset{scheme part/.style={
  black,
  inner sep=0pt,
  draw=black,
  align=center
}}

\begin{document}
\begin{tikzpicture}[domain=0:20,samples=300]
  \begin{pgfonlayer}{foreground}
    \draw[step=1cm,black,thin,opacity=0.2,dashed] (23.9,-0.9) grid (-0.9,15.9);
    % \draw[opacity=0] (23.9,-0.9) grid (-0.9,15.9);

    \draw (0,0) -- (0,15) -- (23,15) -- (23,0) -- (0,0);

    \node[
      scheme part,
      fit={(1,14) (9,3)},
      dashed
    ] (rect) {};
    
    \node[
      scheme part,
      fit={(2,13) (8,11)},
      label=center:Демоны и сервисы
    ] (rect) {};
    
    \draw (2,10) rectangle (8,7) node[align=center, pos=.5] {Flask + \\ Socket.io сервер};
    
    \node[
      scheme part,
      fit={(2,6) (8,4)},
      label=center:RTKLIB
    ] (rect) {};
    
    \draw (12,10) rectangle (16,7) node[align=center, pos=.5] {Socket.io клиент};
    
    \draw (17,10) rectangle (21,7) node[align=center, pos=.5] {Vue.js};
    
    \node[
      scheme part,
      fit={(11,11) (22,6)},
      dashed
    ] (rect) {};
  \end{pgfonlayer}
  
  \begin{pgfonlayer}{background}
    
  \end{pgfonlayer}
\end{tikzpicture}
\end{document}